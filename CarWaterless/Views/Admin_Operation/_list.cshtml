
@model Infra.ViewModels.PagedListClient<Infra.ViewModels.OperationCustomerViewModel>
@using PagedList;
@using PagedList.Mvc;

@if (Model.Results.Count() > 0)
{

    <h5 class="card-title">@Model.TotalCount records found.</h5>


    foreach (var result in Model.Results)
    {
        <div class="main-card mb-3 card br-10">
            <div class="card-body" style="padding-top:15px!important;">

                <div class="row">
                    <div class="col-md-3">
                        <div class="widget-content p-0">
                            <div class="widget-content-wrapper">
                                @*<div class="widget-content-left mr-3">
                        <div class="widget-content-left">
                            <img width="40" class="rounded-circle" src="~/ArchitectThemes/image/admin.jpg" alt="">
                        </div>
                    </div>*@
                                <div class="widget-content-left flex2">
                                    <div class="widget-heading">@result.customer.FullName</div>
                                    <div class="mt-5"><i class="fa fa-car mr-5 theme-color"></i> @result.vehicle.VehicleBrand @result.vehicle.VehicleName <span class="badge badge-secondary mr-10">@result.vehicle.VehicleColor</span></div>
                                    <div class="mt-5"><i class="fa fa-car-alt mr-5 theme-color"></i> @result.carcategory.Name</div>
                                    <div class="mt-5"><i class="fa fa-car mr-5 theme-color"></i> @result.vehicle.VehicleNo</div>
                                    <div class="mt-5"><i class="fa fa-phone-square ml-5 theme-color"></i> @result.customer.PhoneNo</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-4 mt-5">

                        @if (result.operation.Status == "Waiting")
                        {

                            <ol class="progress-meter" id="ol_status_@result.operation.Id">
                                <li class="progress-point done">Waiting</li>
                                <li class="progress-point todo" data-status="Waiting" data-id="@result.operation.Id"
                                    onclick="newstatusChange(this)">Confirmed</li>
                                <li class="progress-point todo">Finished</li>

                            </ol>

                        }
                        else if (result.operation.Status == "Confirmed")
                        {

                            <ol class="progress-meter" id="ol_status_@result.operation.Id">
                                <li class="progress-point done">Waiting</li>
                                <li class="progress-point done">Confirmed</li>
                                <li class="progress-point todo" data-status="Confirmed" data-id="@result.operation.Id"
                                    onclick="newstatusChange(this)">Finished</li>

                            </ol>

                        }
                        else if (result.operation.Status == "Finished")
                        {

                            <ol class="progress-meter" id="ol_status_@result.operation.Id">
                                <li class="progress-point done">Waiting</li>
                                <li class="progress-point done">Confirmed</li>
                                <li class="progress-point done">Finished</li>

                            </ol>

                        }

                        <div class="badge badge-success">@result.operation.WashOption</div>
                        @if (result.operation.WashOption == "In-House")
                        {
                            <p class="mt-10"><i class="fa fa-map-marker-alt"></i> @result.operation.CustomerAddress</p>
                        }


                    </div>



                    <div class="col-md-4 text-right">

                        <div class="">
                            @if (result.carcategory.Type == "medium")
                            {
                                <h6>ကားလတ် - <span class="text text-danger"> @result.carcategory.BasicPrice.Value.ToString("#,##0") MMK</span></h6>
                            }
                            else if (result.carcategory.Type == "big")
                            {
                                <h6>ကားကြီး - <span class="text text-danger"> @result.carcategory.BasicPrice.Value.ToString("#,##0") MMK</span> </h6>

                            }
                            else
                            {
                                <h6>ကားသေး - <span class="text text-danger">@result.carcategory.BasicPrice.Value.ToString("#,##0") MMK</span> </h6>

                            }


                        </div>
                        @{
                            var name = result.operation.AdditionalNames.Split('_').ToList();
                            var price = result.operation.AdditionalPrices.Split('_').ToList();
                        }

                        @for (var i = 0; i < name.Count(); i++)
                        {
                            <div class="mt-10">
                                <h6>@name[i] - <span class="text text-danger">@Convert.ToDouble(price[i]).ToString("#,##0") MMK</span></h6>

                            </div>
                        }

                        <div class="mt-10">
                            <h6>Total - <span class="text text-danger">@result.operation.TotalAmount.Value.ToString("#,##0") MMK</span> </h6>

                        </div>

                    </div>

                    @{ 
                        Infra.ViewModels.AdminViewModel userModel = CarWaterless.Business.CommonRepository.GetLoginData();
                        int userid = userModel.Id;
                    }

                    <div class="col-md-1">
                        <div class="font-icon-wrapper font-icon-lg" onclick="gotochat(this)"
                             data-fromuserid="@userid"
                             data-touserid="@result.operation.CustomerId" 
                             data-operationid="@result.operation.Id">
                           <i class="fa fa-comments icon-gradient bg-tempting-azure cursor-pointer"></i>
                        </div>
                        <div class="font-icon-wrapper font-icon-lg"><i class="fas fa-trash icon-gradient bg-love-kiss cursor-pointer"> </i></div>
                        
                    </div>




                </div>


            </div>
        </div>
    }


    <div class="col-12 mt-20">
        <div class="paginator-wrap pagedList">

            @Html.PagedListPager(Model.Results, page => Url.Action("_list", "Admin_Customer",
       new { page }), PagedListRenderOptions.ClassicPlusFirstAndLast)
        </div>
    </div>

}
else
{


}




